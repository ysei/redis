/*
  Sources:
  http://scitec.uwichill.edu.bb/cmp/online/el21c/lesson18.html
 */
typedef struct
{
	char *mask;
	char *mnem;
	char *para;
	int flags;
}i8085cmds_t;

#define I8085_REG1 1
#define I8085_REG2 2
#define I8085_REGPAIR 4
#define I8085_CC 8
#define I8085_REL8 0x10
#define I8085_I8 0x20
#define I8085_I16 0x40
#define I8085_RST 0x80
#define I8085_REL16 0x100
#define I8085_REGPAIR2 0x200

i8085cmds_t i8085cmds[]={
	{"00000000", "NOP", "", 0},
	{"00000001", "LD", "BC,%s", I8085_I16},
	{"00000010", "LD", "(BC),A", 0},
	{"00000111", "RLC", "", 0},
	{"00001111", "RLA", "", 0}, // carry
	{"00010001", "LD", "DE,%s", I8085_I16},
	{"00010010", "LD", "(DE),A", 0},
	{"00010111", "RRC", "", 0},
	{"00011010", "LD", "A,(DE)", 0},
	{"00011111", "RRA", "", 0}, 
	{"00100000", "RIM", "", 0}, //??
	{"00100001", "LD", "HL,%s", I8085_I16},
	{"00100010", "LD", "(%s),HL", I8085_I16},
	{"00100111", "DAA", "", 0},
	{"00101010", "LD", "HL,(%s)", I8085_I16},
	{"00110111", "SCF", "", 0},
	{"00110110", "LD", "(HL),%s", I8085_I8},

	{"00110001", "LD", "SP,%s", I8085_I16}, 
	{"00110010", "LD", "(%s),A", I8085_I16},
	{"00111010", "LD", "A,(%s)", I8085_I16},

	{"00101111", "CPL", "", 0},
	{"00110000", "SIM", "", 0},
	{"00111111", "CCF", "", 0},

	{"00aa0010", "LD", "(%s),A",I8085_REGPAIR2},
	{"00aa0011", "INC", "%s", I8085_REGPAIR2 }, // pair

	{"00aa1001", "ADD", "HL,%s", I8085_REGPAIR2 },
	{"00aa1010", "LD", "A,(%s)",I8085_REGPAIR2},
	{"00aa1011", "DEC", "%s", I8085_REGPAIR2}, // pair
	{"00aaa100", "INC", "%s", I8085_REG1},
	{"00aaa101", "DEC", "%s", I8085_REG1},
	{"00aaa110", "LD", "%s,%s", I8085_REG1|I8085_I8},

	{"01aaabbb", "LD", "%s,%s", I8085_REG2},
	{"01110110", "HALT", "", 0},
	{"10000aaa", "ADD", "%s", I8085_REG1},
	{"10001aaa", "ADC", "%s", I8085_REG1},
	{"10000110", "ADD", "(HL)", 0},
	{"10001110", "ADC", "(HL)", 0},
	{"11000110", "ADD", "%s", I8085_I8},
	{"11001110", "ADC", "%s", I8085_I8 },

	{"11010110", "SUB", "%s", I8085_I8},
	{"11011110", "SBC", "%s", I8085_I8},
	{"10010aaa", "SUB", "%s", I8085_REG1},
	{"10011aaa", "SBC", "%s", I8085_REG1},

	{"10100aaa", "AND", "%s", I8085_REG1},
	{"10101aaa", "XOR", "%s", I8085_REG1},
	{"10110aaa", "OR", "%s", I8085_REG1},
	{"10111aaa", "CP", "%s", I8085_REG1},


	{"11000011", "JP", "%s", I8085_I16},
	{"11001101", "CALL", "%s",I8085_I16 },
	{"11001001", "RET", "", 0},
	{"11010011", "OUT", "(%s),A", I8085_I8},
	{"11011011", "IN", "A,(%s)", I8085_I8},
	{"11100011", "EX", "(SP),HL", 0},
	{"11100110", "AND", "A,%s", I8085_I8},
	{"11101001", "JP", "(HL)", 0},
	{"11101011", "EX", "DE,HL", 0},
	{"11101110", "XOR", "A,%s", I8085_I8},
	{"11110011", "DI", "", 0},
	{"11110110", "OR", "A,%s", I8085_I8},
	{"11111001", "LD", "HL,SP", 0},
	{"11111011", "EI", "", 0},
	{"11111110", "CMP", "A,%s", I8085_I8},

	{"11aa0001", "POP", "%s",I8085_REGPAIR},
	{"11aaa010", "JP", "%s,%s", I8085_I16|I8085_CC}, // Jcc
	{"11aa0101", "PUSH", "%s", I8085_REGPAIR },       
	
	{"11aaa000", "RET", "%s", I8085_CC},
	{"11aaa100", "CALL", "%s,%s", I8085_I16|I8085_CC},
	{"11aaa111", "RST", "%s", I8085_RST},

	{"aaaaaaaa", "DC.B", "%s", I8085_I8}
};

char *regnum2str[8]={"B","C","D","E","H","L","(HL)","A"};
char *regpair2str1[4]={"BC","DE","HL","PSW"};
char *regpair2str2[4]={"BC","DE","HL","SP"};
char *cc2str[8]={"NZ","Z","NC","C","PO","PE","P","M"};

